<article class="self">
    <h2> 자판기 </h2>
    <div>
        <p class="price">1000원</p>
        <p class="btn">
            <button data-price="300">밀크커피(300)</button>
            <button data-price="400">코코아(400)</button>
            <button data-price="600">율무차(600)</button>
            <button>초기화</button>
        </p>
        <p> 조건) 총금액 1000원
            -> 원하는 커피 2잔을 선택
            -> 선택시 총금액에서 커피값을 빼주세요
            -> 잔액 부족시 메시지 출력(잔액이 부족합니다.)
            -> 초기버튼 클릭시 다시 시작!
        </p>
    </div>
    <style>
        .self {
            width: 500px;
            margin: 100px auto;
            border: 1px solid #aaa;
            padding: 40px;
            text-align: center;
        }

        .price {
            background-color: #000;
            padding: 10px 0;
            color: yellow;
        }

        .btn {
            background-color: #ddd;
            padding: 20px 0;
        }

        .btn button:last-child {
            background-color: red;
        }

        .self p:last-child {
            white-space: pre-line;
            text-align: left;
            line-height: 2;
        }
    </style>
</article>

<!-- 
<script>
    const elPrice = document.querySelector('.price'),
        elBtn = document.querySelectorAll('.btn button');

    let allPrice = 1000;

    function numPrice(n) {
        allPrice -= n;
        if (allPrice < 0) {
            alert('금액이 부족합니다.');
        }
        else {
            elPrice.textContent = `${allPrice}원`;
        };
    };

    
                elBtn.forEach(function(btn,key){
                    btn.onclick=function(){
                        if(key==3){
                            alert('초기화');
                            allPrice=1000; 
                            elPrice.textContent=`${allPrice}원`
                            console.log(elPrice.textContent);
    
                        }
                        else{
                            let result=Number(btn.dataset.price);
                            numPrice(result);
                        }
                    }
                }) 
    
                
            btns.forEach(function (btn, key) {
                btn.addEventListener('click', function () {
                allPrice = allPrice - Number(btn.dataset.price); //현재 남은 가격
                currentPrice.innerHTML = `${allPrice}원`;

                    if (allPrice < 0) {
                        alert("잔액이 부족합니다.");
                        allPrice = allPrice + Number(btn.dataset.price);
                        currentPrice.textContent = `${allPrice} 원`;
                    }

                    if (key == 3) {
                        alert("초기화합니다");
                        allPrice = 1000;
                        currentPrice.textContent = `${allPrice} 원`;
                    }
                });
            });


</script> -->


<script>
    const elCoffee = document.querySelectorAll('.btn button');
    const elPrice = document.querySelector('.price');
    let allPrice = 1000;

    function coffee(num, money){
        
        if(allPrice < money) {
            alert('금액 부족입니다.');
            return;
        }else{
            
            if(key == 3){
                allPrice= 1000;
            }else{
                allPrice = allPrice - money; //Number(el.dataset.price);
            }
            //일처리
    
            elPrice.textContent = allPrice;
        }
        }


    console.log(elCoffee);

    elCoffee.forEach(function(el,key){
        
        el.onclick = function(){
            coffee(key, Number(el.dataset.price));
        // allPrice = 1000 -300; 
        // allPrice = 1000;
        // elPrice.textContent = 1000; 
        }
    })
</script>